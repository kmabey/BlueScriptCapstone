@model IEnumerable<Blue_Script.Scene>
@{
	ViewBag.Title = "My BlueScript";
}
<!--Side Nav & drag and drop area-->
<div class="row-fluid">
	<div class="span2">
		<div class="sidebar">
			<ul class="nav nav-list">
				<li class="nav-header">Add New</li>
				<li>@Html.ActionLink("Scene", "CreateScene", "Home")</li>
				<li>@Html.ActionLink("Character", "AddEditCharacter", "Home", null, new { @id = "openDialog" })</li>
				<li>@Html.ActionLink("Setting", "AddEditSetting", "Home", null, new { @id = "openDialog" })</li>
				<li class="nav-header">Characters</li>
				@foreach (var item in ViewBag.myCharacters)
	  {
					<li>
						@Html.ActionLink((string)item.FullName, "AddEditCharacter", "Home", new { id = item.CharacterID }, new { @class = "editDialog" })
						@Html.ActionLink("X", "DeleteCharacter", new { id = item.CharacterID }, new { @class = "confirmDialog" })
					</li>
	  }
				<li class="nav-header">Settings</li>
				@foreach (var setting in ViewBag.Settings)
	  {
					<li>
						@Html.ActionLink((string)setting.Name, "AddEditSetting", new { id = setting.ID }, new { @class = "editDialog" })
						@Html.ActionLink("X", "DeleteSetting", new { id = setting.ID }, new { @class = "confirmDialog" })
					</li>
	  }
			</ul>
		</div>
	</div>
	<div class="span10">
		<div class="workarea">
			@for (var i = 0; i < Model.Count(); i++)
   {
				<div class="event">
					@Html.Action("ScenePartial", "Home", new { id = Model.ElementAt(i).ID, sID = Model.ElementAt(i).SettingID })
				</div>
					
   }
			<div class="event">
				<a href="@Url.Action("CreateScene", "Home")"><i class="icon-plus-sign-alt icon-4x"></i>
				</a>
			</div>
		</div>
	</div>
</div>

<div id="dialog-confirm" style="display: none">
        <p>
            <span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;"></span>
            Are you sure to delete ?
        </p>
    </div>
    <div id="dialog-edit" style="display: none">
    </div>
<script type="text/javascript">
	$(document).ready(function () {

		//Start of test code.
		$.ajaxSetup({ cache: false });

		$("#openDialog").live("click", function (e) {
			e.preventDefault();
			var url = $(this).attr('href');
			
			$("#dialog-edit").dialog({
				title: 'Add New',
				autoOpen: false,
				resizable: false,
				height: 355,
				width: 400,
				show: { effect: 'drop', direction: "up" },
				modal: true,
				draggable: true,
				open: function (event, ui) {
					$(this).load(url);
				},
				close: function (event, ui) {
					$(this).dialog('close');
				}
			});

			$("#dialog-edit").dialog('open');
			return false;
		});

		$(".editDialog").live("click", function (e) {
			var url = $(this).attr('href');
			$("#dialog-edit").dialog({
				title: 'Edit',
				autoOpen: false,
				resizable: false,
				height: 355,
				width: 400,
				show: { effect: 'drop', direction: "up" },
				modal: true,
				draggable: true,
				open: function (event, ui) {
					$(this).load(url);

				},
				close: function (event, ui) {
					$(this).dialog('close');
				}
			});

			$("#dialog-edit").dialog('open');
			return false;
		});

		$(".confirmDialog").live("click", function (e) {

			var url = $(this).attr('href');
			$("#dialog-confirm").dialog({
				autoOpen: false,
				resizable: false,
				height: 170,
				width: 350,
				show: { effect: 'drop', direction: "up" },
				modal: true,
				draggable: true,
				buttons: {
					"OK": function () {
						$(this).dialog("close");
						window.location = url;

					},
					"Cancel": function () {
						$(this).dialog("close");

					}
				}
			});
			$("#dialog-confirm").dialog('open');
			return false;
		});

		$(".viewDialog").live("click", function (e) {
			var url = $(this).attr('href');
			$("#dialog-view").dialog({
				title: 'View Customer',
				autoOpen: false,
				resizable: false,
				height: 355,
				width: 400,
				show: { effect: 'drop', direction: "up" },
				modal: true,
				draggable: true,
				open: function (event, ui) {
					$(this).load(url);

				},
				buttons: {
					"Close": function () {
						$(this).dialog("close");

					}
				},
				close: function (event, ui) {
					$(this).dialog('close');
				}
			});

			$("#dialog-view").dialog('open');
			return false;
		});

		$("#btncancel").live("click", function (e) {
			$("#dialog-edit").dialog('close');

		});


	});
</script>